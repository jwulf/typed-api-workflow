# Camunda 8 Public API OpenAPI Specification Standards

## Camunda Keys

Marked by: 
- `x-semantic-key: true`
- `$ref: "#/components/schemas/CamundaKey"`
- `format: "<Name>"`

Example: 

```yaml
    ProcessDefinitionKey:
      allOf:
        - $ref: "#/components/schemas/CamundaKey"
        - description: "Key for a process definition. Only use values returned by\
            \ the system."
          format: "ProcessDefinitionKey"
          x-semantic-type: "ProcessDefinitionKey"
```

Camunda Keys are the system-assigned keys that identify a resource in the engine domain. 

Examples: `ProcessInstanceKey`, `DecisionDefinitionKey`. 

They have the following characteristics: 
- Canonical identifier generated and returned by an API request.
- Generated by the engine (Java long format, serialised to string).
- Non-computable on the client (must be retrieved from API).

The schema components are used by the following: 

- `$ref: "#/components/schemas/CamundaKey"`
  - SDK generation. This is used to generate types like `CamundaKey<ProcessDefinitionKey>`
  - SDK generation. Inherits the runtime validation characteristics of `CamundaKey`. 
- `format` 
  - Documentation. Generates output like `string<ProcessDefinitionKey>`
- `x-semantic-key: true`
  - SDK generation. This is used to allow non-SDK users to use primitives (raw string types) while providing SDK users with strong distinct types.

## Semantic key providers

Marked by: 
- `x-semantic-provider: true`
- `$ref: "#/components/schemas/JobKey"`

Example: 

```yaml
jobKey:
    x-semantic-provider: true
    allOf:
    - $ref: "#/components/schemas/JobKey"
    - description: "The key, a unique identifier for the job."
```

Semantic provider fields in API responses are fields that provide a semantic key, rather than just exposing it. 

The schema component is used in the following way: 

- `$ref: "#/components/schemas/JobKey"`
  - Documentation. Used to narrow the type of `string`. Generates output like `string<JobKey>`.
  - SDK generation. Produces types like `CamundaKey<JobKey>`
  - Test generation. Used to generate a dependency graph of API operations.
- `x-semantic-provider: true`
  - Test generation. Used to reason about operations that can satisfy semantic dependencies in chains.

## Non-engine provided system-assigned keys

Marked by: 
- `$ref: "#/components/schemas/CamundaKey"`
- `x-semantic-type: <type>`
- `format: "<format>"`
- `pattern: <pattern>`
- `minLength: <number>`
- `maxLength: <number>`

Example: 

```yaml
EndCursor:
allOf:
- $ref: "#/components/schemas/CamundaKey"
- description: "The end cursor in a search query result set."
    format: "base64"
    x-semantic-type: "EndCursor"
    pattern: '^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}(?:==)?|[A-Za-z0-9+/]{3}=)?$'
    minLength: 2
    maxLength: 300
    example: "WzIyNTE3OTk4MTM2ODcxMDJd"
```
These are additional non-client-computable references returned in API responses.

The schema component is used in the following way: 
- `ref: "#/components/schemas/CamundaKey"`
  - Test generation reasoning
  - SDK generation. Produces types like `CamundaKey<EndCursor>`.
- `x-semantic-type`
  - Test generation reasoning.
  - SDK generation. Produces types like `CamundaKey<EndCursor>`.
- `format`
  - Documentation. Generates output like `string<base64>`.
- `pattern`
  - Documentation. 
  - SDK generation. Generates runtime validation (and narrower types for languages that support it).
- `minLength` / `maxLength`
  - SDK generation. Overrides validation inherited from `CamundaKey`.

  ## Eventual Consistency

  Marked by: 
  - `x-eventually-consistent: true`

  Example: 

```yaml
/user-tasks/{userTaskKey}:
get:
    x-eventually-consistent: true
    tags:
    - "User task"
    operationId: "getUserTask"
    summary: "Get user task"
    description: "Get the user task by the user task key.\n"
```

Endpoints backed by eventually consistent data storage are marked with `true`. Those backed with strongly consistent storage are marked as `false`.

The schema component is used in the following way: 
- `x-eventually-consistent: true`
  - SDK generation. Adds documentation to the developer IDE and enables SDK ergonomics and static analysis of customer applications for race condition resiliency.
  - Documentation. Adds a note that the endpoint is eventually consistent.
- `x-eventually-consistent: false`
  - Documentation. Adds a note that the endpoint is strongly consistent.